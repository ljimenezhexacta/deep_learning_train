# 6. Construyendo tu Primera Red Neuronal con Keras
En esta capítulo se guiará al estudiante a través del proceso de construcción de su primera red neuronal utilizando la biblioteca Keras. Se explicará cómo cargar y preprocesar conjuntos de datos, construir una arquitectura de red neuronal básica, compilar el modelo y ajustar los datos. Se utilizará el ejemplo de reconocimiento de dígitos utilizando el conjunto de datos FASHION_MNIST.

## 6.1. Carga y preprocesamiento de conjuntos de datos

Nuestro primer paso será obtener y preparar nuestros datos, lo que podríamos comparar con la selección de ingredientes para una receta.

```python
from keras.datasets import fashion_mnist

# Cargamos los datos de Fashion MNIST
(train_data, train_labels) , (test_data, test_labels) = fashion_mnist.load_data()
```

Al igual que revisaríamos los ingredientes antes de cocinar, echemos un vistazo a nuestras imágenes y etiquetas de entrenamiento. Para entender mejor nuestras etiquetas, definimos una lista de categorías en el conjunto de datos Fashion MNIST.

```python
# Lista de categorías en el conjunto de datos Fashion MNIST
fashion_mnist_labels = ["Camiseta/top",  # index 0
                        "Pantalón",      # index 1
                        "Suéter",        # index 2
                        "Vestido",       # index 3 
                        "Abrigo",        # index 4
                        "Sandalia",      # index 5
                        "Camisa",        # index 6 
                        "Zapatilla",     # index 7
                        "Bolso",         # index 8 
                        "Botín"]         # index 9

import matplotlib.pyplot as plt

# Muestra la primera imagen en los datos de entrenamiento
plt.imshow(train_data[0])
plt.show()

# Muestra la primera etiqueta en las etiquetas de entrenamiento
print('Primera etiqueta de entrenamiento:', fashion_mnist_labels[train_labels[0]])
```

Para nuestros datos es necesario un preprocesamiento antes de que puedan ser consumidos por nuestra red neuronal. En términos de cocina, estaríamos preparando y cortando nuestros ingredientes para que estén listos para cocinar.

```python
# Revisamos la forma inicial de los datos
print('Forma de los datos de entrenamiento antes del preprocesamiento:', train_data.shape)

# Cambiamos la forma de los datos para que puedan ser introducidos en nuestra red neuronal
train_data = train_data.reshape([60000, 28*28])
test_data = test_data.reshape([10000, 28*28])

print('Forma de los datos de entrenamiento después del preprocesamiento:', train_data.shape)
```

## 6.2. Construcción de una arquitectura de red neuronal básica

Con nuestros datos preparados, es hora de construir nuestra red neuronal.

```python
from keras import models, layers

# Definimos la arquitectura de la red neuronal
model = models.Sequential()
model.add(layers.Dense(512, activation='relu', input_shape=(28*28,)))
model.add(layers.Dense(10, activation='softmax'))
```

Al igual que decidimos y establecemos una receta que queremos cocinar, ahora necesitamos "compilar" nuestra receta.

```python
model.compile(optimizer='rmsprop', 
              loss='categorical_crossentropy', 
              metrics=['accuracy'])
```

## 6.3. Ajuste de datos y entrenamiento del modelo

Antes de iniciar el entrenamiento, necesitamos hacer un ajuste final a nuestros datos. Este es un paso crítico para garantizar que nuestra red neuronal pueda aprender de manera efectiva.

```python
from keras.utils import to_categorical

# Codificamos nuestras etiquetas de categoría en vectores binarios
train_labels = to_categorical(train_labels)
test_labels = to_categorical(test_labels)
```

Ahora, es el momento de "cocinar" nuestros datos. Entrenaremos nuestra red neuronal utilizando los datos de entrenamiento.

```python
model.fit(train_data, train_labels, epochs=5, batch_size=128)
```

Una vez que nuestro modelo esté "cocinado", podemos evaluar qué tan bien nuestra receta funcionó probándola con nuestros datos de prueba.

```python
test_loss, test_acc = model.evaluate(test_data, test_labels)
print('Test accuracy:', test_acc)
```

¡Felicidades! Acabas de construir y entrenar tu primera red neuronal utilizando Keras. Como resultado, tienes una máquina capaz de reconocer y clasificar distintas categorías de ropa a partir de imágenes. Imagina las posibilidades que este tipo de tecnología puede ofrecer en un sinfín de aplicaciones, desde la moda hasta la medicina. Ahora, estás listo para continuar explorando y aprendiendo más sobre el increíble mundo del aprendizaje profundo.